<!DOCTYPE html>
<html lang="en" manifest="cache.appcache">
<head>
 <meta charset="utf-8">
 <title>fliplogic</title>

 <meta name="HandheldFriendly" content="True">
 <meta name="MobileOptimized" content="320">
 <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1, user-scalable=no, minimal-ui">

<style>

html {
font-family: sans-serif;
-ms-text-size-adjust: 100%;
-webkit-text-size-adjust: 100%;
}
html,body {
margin: 0;
min-width: 100px;
min-height: 100px;
}

.zeropoint{
 position: absolute;
 left: 44.5%;
 top: 42%;
 width:12.5%;
 height:12.5%;
 
/* transform: translate(-50%, -50%);*/
 background-color: none;
/* z-index:1000;*/
}


.infobox{
 position: absolute;
 margin: auto;
 width: 70%;
 top: 95%; left: 0; bottom: 0; right: 0;
/* transform: translate(-50%, -50%);*/
 opacity: 0.5;
 text-align:center;
}

.infobox h1{
 font-size: 2em;
}


.infoshow{
 position: absolute;
 margin: auto;
 width: 100%;
 top: -10px; left: 0; bottom: 0; right: 0; 
 z-index: 10;
 opacity: 0.5;
}

.infoshow h1{
 font-size: 3em;
}

.infoshow-fx{
 transition: font-size 1.3s;
 moz-transition: font-size 1.3s;
}

.gamebox{
 position: absolute;
 top: 0%;
 left: 0%;
 width:97%;
 height:97%;
 background: green;
 border-radius: 5px;
}

.gamebox-fx{
 transition: left 1.3s, top 1.3s;
 moz-transition: left 1.3s, top 1.3s;
}


.header{
 position: absolute;
 left: 0px;
 top: 0px;
 width:100%;
 /*opacity: 0.5;*/
 font-size: 2em;
}

.levels{
 position: absolute;
 margin: 15% auto;
 width: 70%;
 top: 0; left: 0; bottom: 0; right: 0; 

 text-align: center;
 font-size: 2em;
 z-index: 100;
}

.levels a{
 font-size: 2em;
}

.fliplogic{
 position: absolute;
 margin: auto;
 top: 0; left: 0; bottom: 0; right: 0; 
/* opacity: 0.5;*/
 text-align: center;
 width:100%;
 height:30%;
 font-size:5em;
 font-family: Geneva, Arial, Helvetica, sans-serif;
}

.fliplogic h1{
 font-size: 0.5em;
 font-color:lightgray;
}


#idReset{
 float:left;
 padding:.25em;
 text-decoration: none;
}

#idLevel{
 float:right;
 padding:.25em;
 text-decoration: none;
}

</style>

</head>

<!--
<body ondragstart="return false;" ondrop="return false;">
-->
<body>
  <div class="fliplogic" style="visibility:visible;">
    <bold>
     <span style="color:blue;">F</span>
      <span style="color:red;">L</span>
   <span style="color:orange;">I</span>
     <span style="color:gray;">P</span>
    <span style="color:green;">L</span>
     <span style="color:blue;">O</span>
     <span style="color:yellow;">G</span>
     <span style="color:lightgray;">I</span>
     <span style="color:green;">C</span>
     <br>
    </bold>
    <h1 style="color:lightgray;">loading</h1>
  </div>
  <div class="header">
   <a id="idReset" href="#">R</a>
   <a id="idLevel" href="#">L</a>
  </div>
  <div class="infobox">

    <p> <strong>How to play</strong>: <br>Click boxes to change colors. <br>One click changes color of clicked box and close neigbours. <br>Some boxes are moved by click. <br>Black boxes never change color. </p>
    <p> <strong>Objective</strong>: <br>Make all boxes same color, except black.  </p>
    <p> <strong>R</strong> (left top) <a href="javascript:levelUpdate( game.i );">reset level</a>.</p> 
    <p> <strong>L</strong> (right top) <a href="javascript:showLevels();window.scrollTo(0,0);">choose level</a>.</p>
    <p> <strong>Tip</strong>: <br>Find symmetry.  </p>
    <p>
    <a href="https://github.com/papercompute/fliplogic" style="font-size:2em;"> <strong><span style="color:blue;">f</span><span style="color:red;">l</span><span style="color:orange;">i</span><span style="color:gray;">p</span><span style="color:black;">l</span><span style="color:blue;">o</span><span style="color:green;">g</span><span style="color:magenta;">i</span><span style="color:blue;">c</span></strong> </a>
    </p>

    <p>
  <a href="https://twitter.com/share" class="twitter-share-button" data-text="Check out #fliplogic a #puzzle #game" data-via="papercompute" data-url="http://papercompute.github.io/fliplogic" data-counturl="https://github.com/papercompute/fliplogic">Tweet</a>

      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    </p>

    <p>
      Created by <a href="mailto:papercompute@gmail.com?subject=fliplogic">papercompute</a><br>      
      Inspired by <a href="http://gabrielecirulli.github.io/2048/">2048</a> and other puzzle games.
    </p>

  </div>

  <div class="infoshow" style="visibility:hidden;">
    <h1 style="text-align: center;"></h1>
  </div>

  <div class="levels" style="visibility:hidden;">
    <strong>
     <span style="color:blue;">l</span>
      <span style="color:red;">e</span>
   <span style="color:orange;">v</span>
     <span style="color:gray;">e</span>
    <span style="color:green;">l</span>
     <span style="color:blue;">s</span>
     <br>
    </strong>
  </div>
  <div class="zeropoint"></div>



<script src="game.js"></script>

<script>

var COLORS = ["orange","gray","blue"];
const IMM_COLOR = "black";
const DEFSCALE = 0.125
var GSCALE = DEFSCALE;

function checkBoxesColor(){
var boxes=document.querySelectorAll(".gamebox");
var color="";
for (var i=0;i<boxes.length;i++){
 if( boxes[i].style.backgroundColor == IMM_COLOR ) {continue;}
 if( color == ""){color=boxes[i].style.backgroundColor;continue;}
 if( boxes[i].style.backgroundColor != color ) {return false;}
}
return true;
}

function updateColor(e){
//console.log("updateColor",e.style.backgroundColor);
var ci=COLORS.indexOf(e.style.backgroundColor); 
if(ci>=0){
 ci=(ci+1) % COLORS.length; 
 e.style.backgroundColor = COLORS[ci];
}
else{
 e.style.backgroundColor = COLORS[0];
}

}


function onclick(e){

var eleft=parseInt(e.target.style.left.slice(0, -1));
var etop=parseInt(e.target.style.top.slice(0, -1));

var boxes=document.querySelectorAll(".gamebox");

for (var i=0;i<boxes.length;i++){
 var x=boxes[i];
 if(x.style.backgroundColor == IMM_COLOR){continue;}
 var xleft=parseInt(x.style.left.slice(0, -1));
 var xtop=parseInt(x.style.top.slice(0, -1));
 if( Math.abs(xleft - eleft) <= 100 && Math.abs(xtop - etop) <= 100 ){
 updateColor(x);
 }
}

if(typeof game.l[game.i].cb!=="undefined"){
 game.l[game.i].cb(e);
}

if(typeof e.target.gcb!=="undefined"){
 e.target.gcb(e.target);
}

if(checkBoxesColor()){
console.log("Yooohoooooooooooooooooo!!!");

var is=document.querySelector(".infoshow");
var ish1=document.querySelector(".infoshow h1");
ish1.innerHTML="Level "+game.i+" complite!";
is.style.visibility="visible";

setTimeout(function() {
 var is=document.querySelector(".infoshow");
 is.style.visibility="hidden";
/* levelUpdate( (game.i+1) % game.l.length ); */
showLevels();
}, 2250);

} // if


}



function levelUpdate(l)
{

if(l>=game.l.length || l<0){ console.log("wrong level",l);return;}

var zp=document.querySelector(".zeropoint");

while (zp.firstChild) {  zp.removeChild(zp.firstChild); }


COLORS.length = 0;

if(typeof game.l[l].gen!=="undefined"){
game.l[l].gen(l);
}

for(var i=0;i<game.l[l].b.length;i++){
 var gb = document.createElement("div");
 gb.setAttribute('class', 'gamebox gamebox-fx');
 gb.gindex=i;
 gb.gcb=game.l[l].b[i][3];
 var color=game.l[l].b[i][2] || "black";
 gb.setAttribute('style', 'background:'+color+';');
 zp.appendChild(gb);
}


var scale=DEFSCALE;
if(typeof game.l[l].scale!=="undefined"){ scale=game.l[l].scale;}
GSCALE=scale;
resize();


var boxes=document.querySelectorAll(".gamebox");

for (var j=0;j<boxes.length;j++){
  boxes[j].onclick=onclick;  
  var color=boxes[j].style.backgroundColor;
   if( COLORS.indexOf(color) < 0 && color!="black") {
  COLORS.push(color);
 }
}

//console.log("COLORS",COLORS);


setTimeout(function() {

var boxes=document.querySelectorAll(".gamebox");
for (var j=0;j<boxes.length;j++){
  var i=boxes[j].gindex;
  boxes[j].setAttribute('style','left:'+(game.l[l].b[i][0]*100)+'%; top:'+(game.l[l].b[i][1]*100)+'%; background:'+game.l[l].b[i][2]+';');
}


}, 50);


game.i=l;

var idLevel=document.getElementById("idLevel");
idLevel.innerHTML='L'+l;

}




function infoShow(cb)
{

var is=document.querySelector(".infoshow");
is.style.visibility="visible";

setTimeout(function() {

var is=document.querySelector(".infoshow");
is.style.visibility="hidden";
cb(game.i);
}, 2250);

}


function showLevels(){
//console.log("showLevels");
var zp=document.querySelector(".zeropoint");
while (zp.firstChild) {  zp.removeChild(zp.firstChild); }

var lvls=document.querySelector(".levels");
//console.log(lvls);
lvls.style.visibility="visible";
}


function hideLevels(){
var lvls=document.querySelector(".levels");
lvls.style.visibility="hidden";
}



(function(){}());

function resize(){
// console.log('resize!')

var box=document.querySelector(".zeropoint");


var ww=window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
var wh=window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight; 


var wm=Math.min(ww,wh);
var p=GSCALE || 0.125;
const maxw=110;
const maxh=110;
//console.log(ww);
//console.log(wh);
var nw=Math.round(wm*p);if(nw>maxw){nw=maxw;}
var nh=Math.round(wm*p);if(nh>maxh){nh=maxh;}
//console.log(nw);console.log(nh);
box.style.width=nw+"px";box.style.height=nh+"px";
}

window.addEventListener("load", function () {
//console.log("load");

var idReset=document.getElementById("idReset");
idReset.onclick=function(){
//console.log("idReset.onclick");
levelUpdate( game.i );
};

var idLevel=document.getElementById("idLevel");
idLevel.onclick=function(){
//console.log("idLevel.onclick");
showLevels();
};


var levels=document.querySelector(".levels");
for(var i=0;i<game.l.length;i++){
 var e = document.createElement("a");
 e.setAttribute('href', '#');
 e.innerHTML=" "+i;
 e.style.textDecoration="none";

 e.onclick=function(e){
//  console.log("onclick",e.target);
  var l=parseInt(e.target.innerHTML);
  if(l>=0 && l<game.l.length){ levelUpdate( l );}
  hideLevels();
 }

 levels.appendChild(e);
}
resize();
//infoShow(levelUpdate);

var fl=document.querySelector(".fliplogic");
fl.style.visibility="hidden";



levelUpdate(game.i);
});

window.addEventListener("resize", function(){
 resize();
}, true);

</script>



<script>

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54107986-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>




